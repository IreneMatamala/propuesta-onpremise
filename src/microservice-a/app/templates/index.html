{% extends "base.html" %}

{% block title %}Inicio - Microservicio A{% endblock %}

{% block content %}
<div class="jumbotron">
    <h1 class="display-4">Bienvenido al Microservicio A</h1>
    <p class="lead">Este es un microservicio Python Flask con frontend integrado.</p>
    <hr class="my-4">
    <p>Características:</p>
    <ul>
        <li>Frontend con Bootstrap 5</li>
        <li>Autenticación de usuarios</li>
        <li>Conexión a PostgreSQL</li>
        <li>API RESTful</li>
        <li>Dockerizado y listo para Kubernetes</li>
    </ul>
    
    <div class="mt-4">
        <h4>Estado del sistema:</h4>
        <div id="health-status" class="alert alert-info">
            Comprobando estado del servicio...
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Health check automático
    fetch('/api/v1/health')
        .then(response => response.json())
        .then(data => {
            const element = document.getElementById('health-status');
            if (data.status === 'healthy') {
                element.className = 'alert alert-success';
                element.innerHTML = `
                    <strong>✅ Sistema Operativo</strong><br>
                    Servicio: ${data.service}<br>
                    Última verificación: ${new Date(data.timestamp).toLocaleString()}
                `;
            } else {
                element.className = 'alert alert-danger';
                element.innerHTML = `
                    <strong>❌ Sistema con problemas</strong><br>
                    Error: ${data.error}
                `;
            }
        })
        .catch(error => {
            document.getElementById('health-status').className = 'alert alert-warning';
            document.getElementById('health-status').innerHTML = 
                '⚠️ No se pudo conectar con el servicio';
        });
});
</script>
{% endblock %}
